
.. index::
   pair: Application ; transactions


.. _appli_transactions:

=========================================================		
The transactions Django application 
=========================================================

.. seealso::

   - :ref:`django_project` 
   - https://medium.com/@hakibenita/bullet-proofing-django-models-c080739be4e#.nmpia5992
   - http://steelkiwi.com/blog/best-practices-working-django-models-python/
   

.. contents::
   :depth: 3
   

python -m django startapp transactions alias python manage.py startapp transactions
====================================================================================

::

    python -m django startapp transactions

::

	(django_test_dates) django_test_dates/project_dates$ tree transactions
	
::
	
	transactions
	├── admin.py
	├── apps.py
	├── __init__.py
	├── migrations
	│   └── __init__.py
	├── models.py
	├── tests.py
	└── views.py


Advice for the Django models
============================

.. seealso::

   - https://medium.com/@hakibenita/bullet-proofing-django-models-c080739be4e#.nmpia5992

The `wonderful article`_ from Haki Benita.

.. _`wonderful article`: https://medium.com/@hakibenita/bullet-proofing-django-models-c080739be4e#.nmpia5992


.. _haki_benita:

Haki Benita 
------------

.. seealso::

   - https://medium.com/@hakibenita 
   - https://twitter.com/be_haki
   - https://medium.com/@hakibenita/bullet-proofing-django-models-c080739be4e#.nmpia5992		
   
   
Update the transactions/models.py module
=========================================


.. code-block:: python 

	#!/usr/bin/python
	# -*- coding: utf8 -*-
	"""


	"""
	import uuid

	from django.db import models

	class Transaction(models.Model):

		# https://docs.djangoproject.com/en/dev/ref/models/options
		class Meta:
			verbose_name = 'Transaction'
			verbose_name_plural = 'Transactions'
			# https://docs.djangoproject.com/en/dev/ref/models/options/#managed
			managed = True
			
			
		id = models.AutoField(
			primary_key=True,
		)
		
		# https://docs.djangoproject.com/en/dev/ref/models/fields/#uuidfield
		uid = models.UUIDField(
			unique=True,
			editable=False,
			default=uuid.uuid4,
			verbose_name='Public identifier',
		)
		
		# https://docs.djangoproject.com/en/dev/ref/models/fields/#charfield
		sender = models.CharField(
			max_length=200
			verbose_name="The sender identifier"        
		)    				
		# https://docs.djangoproject.com/en/dev/ref/models/fields/#DateTimeField
		created = models.DateTimeField(
			blank=True,
			verbose_name="The transaction creation date"
		)
		
		def __str__(self):
			return self.name


		def get_absolute_url(self):
			"""
			https://docs.djangoproject.com/en/dev/ref/class-based-views/generic-editing/
			"""
			return reverse('transactions:detail',
						   kwargs={'pk': self.pk})
						   
                       

Add the *transactions* application in the INSTALLED_APPS list
==============================================================

Update the project_dates/settings.py module::


	INSTALLED_APPS += [
		'transactions'
	]
	

python manage.py  check transactions
=====================================	
	
::
	
    (django_test_dates) project_dates$ python manage.py  check transactions
    
::
    
    System check identified no issues (0 silenced).


python manage.py makemigrations transactions
==============================================

::

	Migrations for 'transactions':
	  transactions/migrations/0001_initial.py:
		- Create model Transaction


The transactions/migrations/0001_initial.py module
---------------------------------------------------


.. code-block:: python
   :linenos:

	# -*- coding: utf-8 -*-
	# Generated by Django 1.10.3 on 2016-11-05 18:32
	from __future__ import unicode_literals

	from django.db import migrations, models
	import uuid


	class Migration(migrations.Migration):

		initial = True

		dependencies = [
		]

		operations = [
			migrations.CreateModel(
				name='Transaction',
				fields=[
					('id', models.AutoField(primary_key=True, serialize=False)),
					('uid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True, verbose_name='Public identifier')),
					('sender', models.CharField(max_length=200, verbose_name='The sender identifier')),
					('created', models.DateTimeField(blank=True, verbose_name='The transaction creation date')),
				],
				options={
					'verbose_name': 'Transaction',
					'verbose_name_plural': 'Transactions',
					'managed': True,
				},
			),
		]


python manage.py sqlmigrate transactions 0001
===============================================

For information.

::

    (django_test_dates) project_dates$ python manage.py sqlmigrate transactions 0001
    
::
    
	BEGIN;
	--
	-- Create model Transaction
	--
	CREATE TABLE "transactions_transaction" ("id" integer NOT NULL PRIMARY KEY AUTOINCREMENT, "uid" char(32) NOT NULL UNIQUE, "sender" varchar(200) NOT NULL, "created" datetime NOT NULL);
	COMMIT;



python manage.py migrate transactions 
======================================

::

	Operations to perform:
	  Apply all migrations: transactions
	Running migrations:
	  Applying transactions.0001_initial... OK














	
	   
   
		
		
